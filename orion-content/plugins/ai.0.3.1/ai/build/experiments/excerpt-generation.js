(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};window.React;const t=window.wp.editPost,n=window.wp.plugins,r=window.wp.components,o=window.wp.primitives,i=window.ReactJSXRuntime;var c=(0,i.jsx)(o.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,i.jsx)(o.Path,{d:"m11.3 17.2-5-5c-.1-.1-.1-.3 0-.4l2.3-2.3-1.1-1-2.3 2.3c-.7.7-.7 1.8 0 2.5l5 5H7.5v1.5h5.3v-5.2h-1.5v2.6zm7.5-6.4-5-5h2.7V4.2h-5.2v5.2h1.5V6.8l5 5c.1.1.1.3 0 .4l-2.3 2.3 1.1 1.1 2.3-2.3c.6-.7.6-1.9-.1-2.5z"})});const a=window.wp.i18n,s=window.wp.apiFetch;var l=e.n(s);const p=window.wp.data,u=window.wp.editor,d=window.wp.element,w=window.wp.notices,{aiExcerptGenerationData:x}=window;function m(){const e=(0,p.select)(u.store).getCurrentPostId(),t=(0,p.select)(u.store).getEditedPostContent(),n=(0,p.select)(u.store).getEditedPostAttribute("excerpt"),{editPost:r}=(0,p.useDispatch)(u.store),[o,i]=(0,d.useState)(!1);return{isGenerating:o,hasExcerpt:n&&n.trim().length>0,handleGenerate:async()=>{i(!0),(0,p.dispatch)(w.store).removeNotice("ai_excerpt_generation_error");try{const n=await async function(e,t){var n;return l()({path:null!==(n=x?.path)&&void 0!==n?n:"",method:"POST",data:{input:{content:t,post_id:e}}}).then(e=>e&&"string"==typeof e?e:"").catch(e=>{throw new Error(e.message)})}(e,t);r({excerpt:n});const o=document.querySelector(".editor-post-excerpt .editor-post-excerpt__textarea textarea");if(o){const e=Object.getOwnPropertyDescriptor(window.HTMLTextAreaElement.prototype,"value")?.set;e?e.call(o,n):o.value=n,o.focus();const t=new Event("change",{bubbles:!0,cancelable:!0});o.dispatchEvent(t)}}catch(e){(0,p.dispatch)(w.store).createErrorNotice(e,{id:"ai_excerpt_generation_error",isDismissible:!0})}finally{i(!1)}}}}const{aiExcerptGenerationData:h}=window;function g(){const{isGenerating:e,hasExcerpt:t,handleGenerate:n}=m();if(!h?.enabled)return null;const o=t?(0,a.__)("Re-generate excerpt","ai"):(0,a.__)("Generate excerpt","ai");return(0,i.jsx)(r.Button,{icon:c,variant:"secondary",onClick:n,disabled:e,isBusy:e,children:o})}const{aiExcerptGenerationData:b}=window;function v(){const{isGenerating:e,hasExcerpt:t,handleGenerate:n}=m();if(!b?.enabled)return null;const o=t?(0,a.__)("Re-generate excerpt","ai"):(0,a.__)("Generate excerpt","ai");return(0,i.jsx)(r.Button,{icon:c,variant:"link",size:"small",onClick:n,disabled:e,isBusy:e,className:"ai-excerpt-inline-button",label:o,showTooltip:!0})}(0,n.registerPlugin)("excerpt-generation",{render:()=>{const e=(0,t.__experimentalPluginPostExcerpt)();if(!e)return null;const n=e;return(0,i.jsx)(n,{className:"ai-excerpt-generation",children:(0,i.jsx)(g,{})})}}),(0,n.registerPlugin)("excerpt-generation-inline",{render:function(){return(0,d.useEffect)(()=>{let e=!1,t=null,n=null,r=null;const o=()=>{if(e)return;const c=document.querySelector('.editor-post-excerpt__dropdown button[class*="components-button"]');if(!c){const e=function(e,t,n,r=200){let o=0,i=null;const c=()=>{o<n&&(o++,i=setTimeout(()=>{i=null,e()?t():c()},r))};return()=>{i||c()}}(()=>!!document.querySelector('.editor-post-excerpt__dropdown button[class*="components-button"]'),o,20);return void e()}c.parentElement?.querySelector(".ai-excerpt-inline-wrapper")?e=!0:(n=document.createElement("span"),n.className="ai-excerpt-inline-wrapper",n.style.cssText="float: right;",c.parentElement?.insertBefore(n,c.nextSibling),t=(0,d.createRoot)(n),t.render((0,i.jsx)(v,{})),e=!0,r=new MutationObserver(()=>{document.querySelector(".ai-excerpt-inline-wrapper")||(e=!1,o())}),r.observe(document.body,{childList:!0,subtree:!0}))},c=setTimeout(o,500);return()=>{clearTimeout(c),t&&t.unmount(),n&&n.remove(),r&&r.disconnect()}},[]),(0,i.jsx)(i.Fragment,{})}})})();